<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rusty Degen | Jackpot</title>
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;500;600;700&family=Titillium+Web:wght@300;400;600;700&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<body>
    <div class="modal age-verification" id="ageVerificationModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Age Verification</h2>
            </div>
            <div class="modal-body">
                <p>You must be at least 18 years old to use this site.</p>
                <p>By clicking "Agree" you confirm that:</p>
                <ul>
                    <li>You are at least 18 years old</li>
                    <li>You are legally allowed to trade skins from your country</li>
                    <li>You understand and accept the risks associated with skin gambling</li>
                </ul>
                <div class="checkbox-container">
                    <input type="checkbox" id="agreeCheckbox">
                    <label for="agreeCheckbox">I confirm I meet all requirements</label>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" id="agreeButton" disabled>Agree</button>
            </div>
        </div>
    </div>

    <div class="modal deposit-modal" id="depositModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Deposit Items</h2>
                <button class="close-btn" id="closeDepositModal">&times;</button>
            </div>
            <div class="modal-body">
                <div id="inventory-loading" class="loading-indicator">
                    <div class="spinner"></div>
                    <p>Loading your inventory...</p>
                </div>
                <div class="inventory-container">
                    <h3>Your Inventory</h3>
                    <div class="inventory-items" id="inventory-items">
                        <!-- Inventory items will be loaded dynamically -->
                    </div>
                </div>
                <div class="selected-items">
                    <h3>Selected Items</h3>
                    <div class="selected-items-container" id="selectedItems">
                        <!-- Selected items will appear here -->
                    </div>
                    <div class="total-value">
                        <span>Total Value: </span>
                        <span id="totalValue">$0.00</span>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" id="depositButton">Deposit Items</button>
            </div>
        </div>
    </div>

    <div class="modal" id="tradeUrlModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Set Your Trade URL</h2>
                <button class="close-btn" id="closeTradeUrlModal">&times;</button>
            </div>
            <div class="modal-body">
                <p>Please enter your Steam Trade URL to complete deposits and receive winnings:</p>
                <div class="form-group">
                    <input type="text" id="tradeUrlInput" placeholder="https://steamcommunity.com/tradeoffer/new/?partner=...">
                </div>
                <p class="help-text">
                    You can find your trade URL in your 
                    <a href="https://steamcommunity.com/my/tradeoffers/privacy" target="_blank">Steam Trade Privacy Settings</a>.
                </p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" id="saveTradeUrl">Save Trade URL</button>
            </div>
        </div>
    </div>

    <div class="modal spin-wheel-modal" id="spinWheelModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Jackpot Winner</h2>
                <button class="close-btn" id="closeSpinModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="roulette-container">
                    <div class="roulette-track" id="modalRouletteTrack">
                        <!-- Roulette items will be added dynamically -->
                    </div>
                    <div class="roulette-ticker">
                        <div class="ticker-line"></div>
                        <div class="ticker-arrow"></div>
                    </div>
                </div>
                <div class="winner-info" id="modalWinnerInfo">
                    <!-- Winner info will be displayed here -->
                </div>
                <audio id="modalSpinSound" src="audio/spin-sound.mp3" preload="auto"></audio>
            </div>
        </div>
    </div>

    <header class="main-header">
        <div class="container">
            <div class="logo">
                <h1>RUSTY<span>DEGEN</span></h1>
            </div>
            <nav class="main-nav">
                <ul>
                    <li><a href="#" class="active">JACKPOT</a></li>
                    <li><a href="#" id="faq-link">FAQ</a></li>
                    <li><a href="#" id="fair-link">PROVABLY FAIR</a></li>
                </ul>
            </nav>
            <div class="user-controls">
                <button class="btn btn-login" id="loginButton">
                    <i class="fa-brands fa-steam"></i> Sign in
                </button>
                <div class="user-profile" id="userProfile" style="display: none;">
                    <img src="/img/default-avatar.png" alt="User Avatar" class="user-avatar" id="userAvatar">
                    <span class="user-name" id="userName">PlayerName</span>
                </div>
            </div>
        </div>
    </header>

    <main class="main-content">
        <div class="container">
            <!-- Home/Jackpot Page -->
            <div id="home-page">
                <div class="jackpot-section">
                    <div class="jackpot-header" id="jackpotHeader">
                        <div class="jackpot-value">
                            <h2 id="potValue">$0.00</h2>
                            <span class="value-label">CURRENT POT</span>
                        </div>
                        <div class="jackpot-timer">
                            <div class="timer-circle">
                                <svg class="timer-progress" viewBox="0 0 100 100">
                                    <circle class="timer-background" cx="50" cy="50" r="45"></circle>
                                    <circle class="timer-foreground" cx="50" cy="50" r="45"></circle>
                                </svg>
                                <div class="timer-text">
                                    <span id="timerValue">120</span>
                                </div>
                            </div>
                            <span class="timer-label">SECONDS LEFT</span>
                        </div>
                        <div class="jackpot-stats">
                            <div class="stat">
                                <span class="stat-value" id="participantCount">0/200</span>
                                <span class="stat-label">PARTICIPANTS</span>
                            </div>
                        </div>
                        
                        <!-- Inline roulette container (placed inside header) -->
                        <div class="inline-roulette" id="inlineRoulette">
                            <div class="roulette-container">
                                <div class="roulette-track" id="rouletteTrack">
                                    <!-- Roulette items will be added dynamically -->
                                </div>
                                <div class="roulette-ticker">
                                    <div class="ticker-line"></div>
                                    <div class="ticker-arrow"></div>
                                </div>
                            </div>
                            
                            <!-- Winner info overlay -->
                            <div class="winner-info" id="winnerInfo">
                                <div class="winner-header">
                                    <img src="" alt="Winner Avatar" class="winner-avatar" id="winnerAvatar">
                                    <h3 id="winnerName">WINNER NAME</h3>
                                </div>
                                <div class="winner-details">
                                    <p>Deposited: <span id="winnerDeposit">$0.00</span></p>
                                    <p>Chance: <span id="winnerChance">0.00%</span></p>
                                    <p class="congrats">Congratulations!</p>
                                </div>
                                <div class="confetti-container" id="confettiContainer"></div>
                            </div>
                            
                            <!-- Sound effect for spin animation -->
                            <audio id="spinSound" src="audio/spin-sound.mp3" preload="auto"></audio>
                            
                            <!-- Return button (can be hidden as animation auto-resets) -->
                            <button class="btn btn-primary return-btn" id="returnToJackpot">Return to Jackpot</button>
                        </div>
                    </div>

                    <div class="deposit-button-container" id="depositBtnContainer">
                        <button class="btn btn-deposit" id="showDepositModal">DEPOSIT SKINS</button>
                        <button class="btn btn-secondary" id="testSpinButton" style="margin-top: 10px;">Test Roulette Animation</button>
                    </div>

                    <div class="current-items-section" id="currentItems">
                        <h3 class="section-title">CURRENT ITEMS IN POT</h3>
                        <div class="participants-container" id="participantsContainer">
                            <!-- Participants will be loaded dynamically -->
                            <div class="empty-pot-message" id="emptyPotMessage">
                                <p>No items in the current pot. Be the first to deposit!</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- FAQ Page -->
            <div id="faq-page" style="display: none;">
                <div class="content-card">
                    <h1>Frequently Asked Questions</h1>
                    
                    <div class="faq-item">
                        <div class="faq-question">How does Rusty Degen work?</div>
                        <div class="faq-answer">
                            Rusty Degen is a Rust skin jackpot site where players can deposit their skins into a pool. When the timer runs out, a winner is randomly selected. The winner takes all skins in the pot. Your chance of winning is proportional to the value of skins you've deposited compared to the total pot value.
                        </div>
                    </div>
                    
                    <div class="faq-item">
                        <div class="faq-question">How do I deposit skins?</div>
                        <div class="faq-answer">
                            First, log in with your Steam account. Then click the "Deposit Skins" button, which will open a window showing your Rust inventory. Select the skins you want to deposit and confirm. You'll then receive a trade offer that you must accept to complete the deposit.
                        </div>
                    </div>
                    
                    <div class="faq-item">
                        <div class="faq-question">How is the winner selected?</div>
                        <div class="faq-answer">
                            The winner is selected using a provably fair system. Each player gets tickets proportional to the value of their deposited skins. A random ticket is selected as the winner. See our "Provably Fair" page for more details.
                        </div>
                    </div>
                    
                    <div class="faq-item">
                        <div class="faq-question">How do I receive my winnings?</div>
                        <div class="faq-answer">
                            If you win, all items in the pot will be automatically sent to you via a Steam trade offer. Make sure your trade URL is set correctly in your profile and that your inventory is public.
                        </div>
                    </div>
                    
                    <div class="faq-item">
                        <div class="faq-question">Is there a minimum deposit value?</div>
                        <div class="faq-answer">
                            Yes, the minimum deposit value is $1.00. Items worth less than this amount cannot be deposited.
                        </div>
                    </div>
                    
                    <div class="faq-item">
                        <div class="faq-question">What is your fee?</div>
                        <div class="faq-answer">
                            Rusty Degen takes a 5% fee from each pot to cover operational costs and ensure the long-term sustainability of the site.
                        </div>
                    </div>
                </div>
            </div>

            <!-- Provably Fair Page -->
            <div id="fair-page" style="display: none;">
                <div class="content-card">
                    <h1>Provably Fair System</h1>
                    
                    <div class="fair-section">
                        <div class="fair-title">How Our System Works</div>
                        <div class="fair-content">
                            Rusty Degen uses a provably fair system to ensure complete transparency and fairness in winner selection. Our system uses cryptographic methods to guarantee that the results cannot be manipulated and can be independently verified by anyone.
                        </div>
                    </div>
                    
                    <div class="fair-section">
                        <div class="fair-title">The Process</div>
                        <div class="fair-content">
                            <ol>
                                <li>When a round begins, the server generates a random string called the "server seed" and creates a SHA256 hash of it. This hash is publicly displayed before any deposits are made.</li>
                                <li>As players deposit items, they are assigned ticket numbers proportional to the value of their deposits.</li>
                                <li>When the round ends, we combine the server seed with a "client seed" (which is the round ID plus timestamp) to generate a random number.</li>
                                <li>This random number determines which ticket wins the pot.</li>
                            </ol>
                        </div>
                    </div>
                    
                    <div class="fair-section">
                        <div class="fair-title">Verification</div>
                        <div class="fair-content">
                            After each round, we publish the original server seed that was used to create the hash. You can verify that:
                            <ul>
                                <li>The hash displayed at the beginning of the round matches the server seed revealed at the end.</li>
                                <li>The winning ticket was correctly determined using our formula.</li>
                            </ul>
                            This ensures that we cannot manipulate the outcome, as the server seed is committed before any deposits are made.
                        </div>
                    </div>
                    
                    <div class="fair-section">
                        <div class="fair-title">Verification Tool</div>
                        <div class="fair-content">
                            You can use our verification tool below to check any past round:
                            <div class="verify-form">
                                <div class="form-group">
                                    <label>Round ID: </label>
                                    <input type="text" id="round-id" placeholder="Enter round ID">
                                </div>
                                <div class="form-group">
                                    <label>Server Seed: </label>
                                    <input type="text" id="server-seed" placeholder="Enter server seed">
                                </div>
                                <div class="form-group">
                                    <label>Client Seed: </label>
                                    <input type="text" id="client-seed" placeholder="Enter client seed">
                                </div>
                                <button class="btn btn-primary" id="verify-btn">Verify</button>
                            </div>
                            <div id="verification-result"></div>
                        </div>
                    </div>
                    
                    <div class="fair-section">
                        <div class="fair-title">Past Rounds</div>
                        <div class="fair-content">
                            <div class="rounds-table-container">
                                <table class="rounds-table">
                                    <thead>
                                        <tr>
                                            <th>Round ID</th>
                                            <th>Date</th>
                                            <th>Total Value</th>
                                            <th>Winner</th>
                                            <th>Details</th>
                                        </tr>
                                    </thead>
                                    <tbody id="rounds-table-body">
                                        <tr>
                                            <td colspan="5">Loading past rounds...</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="pagination" id="rounds-pagination">
                                <!-- Pagination will be added dynamically -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
        </div>
    </main>

    <footer class="main-footer">
        <div class="container">
            <p>&copy; 2025 Rusty Degen. All rights reserved. Gambling can be addictive. Play responsibly.</p>
        </div>
    </footer>

    <!-- Socket.io -->
    <script src="/socket.io/socket.io.js"></script>
    
    <!-- Main JavaScript -->
    <script src="/js/main.js"></script>
</body>
</html>
